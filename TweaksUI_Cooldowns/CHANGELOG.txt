TweaksUI: Cooldowns Changelog
================================

v2.0.0 - Midnight Pre-Patch Release
-----------------------------------

### Breaking Changes
- **Midnight-Only**: Requires World of Warcraft 12.0.0 (Midnight) or later
- For The War Within support, use version 1.5.x

### New Features

**Dynamic Docks System**
- Group icons from ANY tracker into combined dock containers
- Create up to 10 custom docks for flexible layouts
- Assign icons via Per-Icon settings "Move to Dock" dropdown
- Each dock has independent settings:
  - Icon size, columns, spacing, grow direction
  - Visibility: Combat, Solo/Party/Raid, Target, Mounted states
  - Fully positionable via Layout Mode

**Visual Override for Docks**
- Override appearance of docked icons without affecting source tracker
- Customizable: Size, opacity, border width/color
- Desaturation and inactive state settings
- Countdown text: scale, color, position offset
- Proc glow toggle per icon

**New Visibility Options**
- Target/No Target visibility for all trackers and docks
- Mounted/Dismounted visibility for all trackers and docks
- Per-icon proc glow toggle (uses IsSpellOverlayed API)

**Setup Wizard**
- Guided first-run configuration for new users

**Global Scale**
- Scale settings panels from 50% to 200%
- `/tuicdscale` command for quick access

### Improvements
- Midnight API compatibility (Duration Objects, safe value comparisons)
- 60-80% CPU reduction in raid environments
- Optimized update handlers and layout calculations

### Bug Fixes
- Fixed per-icon visibility during GCD
- Fixed icon key parsing for Visual Override
- Icons no longer briefly hide when any ability triggers GCD

---

v1.5.4 - Removed Debug Chat Spam
--------------------------------

### Bug Fixes
- Disabled all debug print functions across all modules
- No more layout change spam in chat
- No more tracker update spam in chat

---

v1.5.3 - Fixed Proc Glows Not Showing
-------------------------------------

### Bug Fixes
- **MAJOR FIX: Blizzard's native proc glows (SpellActivationAlert) now work correctly**
  - Root cause: `useMasque` was defaulting to `true` but should be `false`
  - The Masque integration code aggressively hides all child frame textures
  - This was inadvertently hiding Blizzard's SpellActivationAlert glow frames
  - Changed default to `false` to match expected behavior
  
- **Added protection for glow frames even when Masque is enabled**
  - AddToMasque now skips child frames named: SpellActivation, Overlay, Glow, Alert
  - This allows proc glows to display properly even with Masque skinning enabled

---

v1.5.2 - Per-Icon Text & Hide Options
-------------------------------------

### New Features
- Per-Icon Text Options
  - Custom countdown text settings per icon slot
  - Font size override (independent of global cooldown text size)
  - Font color customization with color picker
  - Horizontal and vertical offset controls for precise positioning
  - Works for Essential, Utility, Buffs, and Custom trackers

- Hide Icon in Tracker
  - New checkbox in Per-Icon Settings panel
  - Hides the icon in the main tracker while keeping it in the grid layout
  - Per-icon highlight remains visible and independently positionable
  - Useful for creating custom icon arrangements using only the highlight system

### Bug Fixes
- Fixed per-icon text settings not saving correctly in profiles
- Fixed per-icon highlight not restoring properly when un-hiding a buff icon
- Fixed cooldown state detection being affected by hidden icon alpha

---

v1.5.0 - Custom Grid Mode & Alignment
-------------------------------------

### Important Migration Notice
If you were using a Custom Pattern before this update, you must now:
1. Check the "Enable Custom Grid Pattern" checkbox in the Layout tab
2. Your existing pattern will be preserved, just needs to be enabled
3. This needs to be done once per character or profile

### New Features
- Custom Grid system completely redesigned
  - "Enable Custom Grid Pattern" checkbox to activate custom layout
  - Mode selection: Row Mode (fills right then down) or Column Mode (fills down then right)
  - Alignment options: Start (Left/Top), Center (Middle), End (Right/Bottom)
  - Works independently from standard layout Direction & Alignment settings
  - Pattern edit box with Apply button
  - Use 0 for blank rows/columns (e.g., 3,0,3 = gap in middle)
- Overflow icons properly continue in additional rows/columns
- Alignment applies to ALL rows/columns, not just the first
- Overflow rows/columns properly align based on actual icon count

### Improvements
- Reset Layout Settings button now resets all layout options including custom grid
- Reload prompt when enabling/disabling custom grid for clean state
- Better debug output for troubleshooting layout issues

---

v1.3.0 - Combat Opacity, Layout Fixes & QoL
-------------------------------------------

### New Features
- Combat-based opacity settings
  - Separate "Out of Combat Opacity" and "In Combat Opacity" sliders
  - Found in the Appearance tab for all trackers
  - Opacity automatically updates when entering/leaving combat
- Custom layout now supports 0 for empty/blank rows
  - Example: "1,0,3" creates 1 icon, then a blank row, then 3 icons
  - Works with both horizontal and vertical primary growth directions
- Per-icon custom labels (accessibility)
  - Add custom text labels to any tracked icon
  - Configurable font size, color, and position offsets
- Clickthrough option for trackers
  - Allow mouse clicks to pass through tracker frames
  - Found in Visibility tab under "Interaction"

### Bug Fixes
- Fixed minimap button icon alignment within the circular border
- Fixed move boxes (overlays) being larger than actual tracker grid
- Fixed move boxes not centered over trackers
- Fixed CENTER/RIGHT alignment not working on non-top rows for vertical layouts
- Fixed Compress button using wrong spacing value (now uses -5 to actually compress)
- Fixed count text settings affecting cooldown countdown numbers

### Improvements
- Increased update rate to 20Hz for snappier icon responsiveness

---

v1.1.2 - Layout Mode Enhancements & QoL
---------------------------------------

### New Features
- Enhanced Layout Mode
  - Grid overlay with center crosshairs (toggle with /tuicdlayout grid)
  - Keyboard nudging: Arrow keys (1px), Shift+Arrow (10px)
  - Click-to-select with color-coded visual states
  - Press ESC to exit Layout Mode
- Per-tracker tooltip toggle
  - Disable mouseover tooltips for any tracker individually
  - Setting found in Visibility tab of each tracker
- New convenience slash commands
  - /rl - Reload UI
  - /cmt - Alias for /tuicd (familiar for CMT users)
  - /em - Toggle Edit Mode
  - /cdm - Open Blizzard Cooldown Manager

### Bug Fixes
- Fixed "Couldn't find region named 'TUICD_Container_essential'" error on login
  - Containers now created at file load before Edit Mode runs
- Fixed glow effect on custom tracker icons
  - Removed cooldown bling/edge textures causing the visual glitch

---

v1.1.0 - Masque Support
------------------------

### New Features
- Full Masque skinning support
  - Each tracker (Essential, Utility, Buffs, Custom) is a separate Masque group
  - Enable per-tracker in Appearance settings
  - Groups appear under "TweaksUI: Cooldowns" in Masque settings
- Deferred Masque initialization fixes load order issues
- Improved icon button structure for better skin compatibility

### Improvements
- Better cooldown frame layering
- What's New popup on version update

---

v1.0.0 (Initial Release)
------------------------
This is the first release of TweaksUI: Cooldowns, formerly known as Cooldown Manager Tweaks (CMT).

### What's New
- Rebranded from "Cooldown Manager Tweaks" to "TweaksUI: Cooldowns"
- Part of the TweaksUI family of addons
- Automatic migration from CMT settings (no configuration lost!)
- NEW: Layout Mode for easy frame positioning

### Features (carried over from CMT 4.6.3)
- Custom grid layouts for Essential Cooldowns, Utility Cooldowns, and Buff Tracker
- Per-tracker icon size, spacing, columns, and grow direction settings
- Icon zoom and aspect ratio customization
- Cooldown and stack count text scaling
- Visibility controls (combat, group, target, instance type)
- Custom Tracker system for tracking spells, items, and equipped on-use gear
- Persistent Buff Display with greyscale inactive state
- Buff Highlights and Cooldown Highlights for proc alerts (in development)
- Masque skin support
- Profile import/export (coming soon)

### Layout Mode
Click "Unlock Frames" in the settings hub to enter Layout Mode:
- All tracker frames become draggable
- Blue overlays show frame names
- Drag any frame to reposition
- Click "Lock Frames" when done
- Positions are saved automatically

You can also use /tuicdlayout to toggle Layout Mode.

### Migration from CMT
If you previously had Cooldown Manager Tweaks installed:
1. Your settings will be automatically migrated on first load
2. The old CMT saved variables are read through a migration helper
3. All profiles and custom tracker entries are preserved

### Slash Commands
- /tuicd - Open settings hub
- /tuicd debug - Toggle debug mode
- /tuicd reset - Reset all settings
- /tuicdlayout - Toggle Layout Mode (unlock/lock frames)
- /tuicdmigrate status - Check CMT migration status
- /tuicdmigrate force - Force re-migration from CMT

### Looking for More?
Check out the full TweaksUI suite for:
- UnitFrames customization
- CastBars styling  
- Nameplates enhancements
- ActionBars tweaks
- Chat improvements
- And more!

Visit: https://www.curseforge.com/wow/addons/tweaksui
